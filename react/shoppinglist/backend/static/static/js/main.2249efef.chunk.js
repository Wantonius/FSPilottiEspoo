(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{182:function(e,t,n){e.exports=n(318)},187:function(e,t,n){},189:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},190:function(e,t,n){},318:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(51),i=n.n(o),s=(n(187),n(25)),c=n(26),l=n(29),u=n(27),p=n(30),g=(n(189),n(190),n(326)),d=n(329),m=function(e){return function(t){var n={method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};t(I()),fetch("/register",n).then(function(e){e.ok?(t(f()),alert("Register successful!")):(t(S("Username already in use")),alert("Username already in use"))}).catch(function(e){t(S("Server not responding"))})}},h=function(e){return function(t){var n={method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};t(I()),fetch("/login",n).then(function(e){e.ok?e.json().then(function(e){t(O())}).catch(function(e){t(L("Server responded with error"))}):t(L("Wrong credentials"))}).catch(function(e){t(L("Server responded with error"))})}},E=function(){return function(e){e(I()),fetch("/logout",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}}).then(function(t){t.ok?e(b()):e(v("Server responded with status:"+t.status))}).catch(function(t){e(v("Server responded with error"))})}},f=function(){return{type:"REGISTER_SUCCESS"}},S=function(e){return{type:"REGISTER_FAILED",error:e}},O=function(){return{type:"LOGIN_SUCCESS"}},L=function(e){return{type:"LOGIN_FAILED",error:e}},b=function(){return{type:"LOGOUT_SUCCESS"}},v=function(e){return{type:"LOGOUT_FAILED",error:e}},I=function(){return{type:"LOGIN_LOADING"}},y=n(28),C=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).logout=function(){n.props.dispatch(E())},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e;return e=this.props.isLogged?a.a.createElement(d.a,null,a.a.createElement(d.a.Item,null,a.a.createElement(g.a,{name:"list",to:"/list"},"Shopping List")),a.a.createElement(d.a.Item,null,a.a.createElement(g.a,{name:"form",to:"/form"},"Add Item")),a.a.createElement(d.a.Item,null,a.a.createElement(g.a,{name:"logout",to:"/",onClick:this.logout},"Logout"))):a.a.createElement("div",{style:{height:65}}),this.props.error.length>0&&(e=a.a.createElement("div",{style:{height:65}},a.a.createElement("p",null,"Error:",this.props.error))),this.props.loading&&(e=a.a.createElement("div",{style:{height:65}},a.a.createElement("p",null," Loading ..."))),a.a.createElement("div",null,e)}}]),t}(a.a.Component),j=Object(y.b)(function(e){var t=!1,n="";return(e.login.loading||e.shopping.loading)&&(t=!0),e.shopping.error.length>0&&(n=e.shopping.error),e.login.error.length>0&&(n=e.login.error),{isLogged:e.login.isLogged,loading:t,error:n}})(C),_=n(335),T=n(327),G=n(333),P=n(330),w=n(331),D=function(){return function(e){e(J()),fetch("/api/shopping",{method:"GET",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}}).then(function(t){t.ok?t.json().then(function(t){e(k(t))}).catch(function(t){e(A("Problem loading shopping list"))}):e(A("Response not ok. Status:"+t.status))}).catch(function(t){e(A("Problem loading shopping list"))})}},F=function(e){return function(t){var n={method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};t(J()),fetch("/api/shopping",n).then(function(e){e.ok?(t(R()),t(D())):t(H("Response not ok. Status:"+e.status))}).catch(function(e){t(H("Server responded with error"))})}},N=function(e){return function(t){t(J()),fetch("/api/shopping/"+e,{method:"DELETE",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}}).then(function(e){e.ok?(t(U()),t(D())):t(x("Response not ok. Status:"+e.status))}).catch(function(e){t(x("Server responded with error"))})}},k=function(e){return{type:"GET_SHOPPINGLIST_SUCCESS",list:e}},A=function(e){return{type:"GET_SHOPPINGLIST_FAILED",error:e}},R=function(){return{type:"ADD_TO_SHOPPINGLIST_SUCCESS"}},H=function(e){return{type:"ADD_TO_SHOPPINGLIST_FAILED",error:e}},U=function(){return{type:"DELETE_FROM_SHOPPINGLIST_SUCCESS"}},x=function(e){return{type:"DELETE_FROM_SHOPPINGLIST_FAILED",error:e}},J=function(){return{type:"SHOPPINGLIST_LOADING"}},M=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).remove=function(e){n.props.dispatch(N(e.target.name))},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.isLogged&&this.props.dispatch(D())}},{key:"render",value:function(){var e=this,t=this.props.list.map(function(t){return a.a.createElement(P.a.Row,{key:t._id},a.a.createElement(P.a.Cell,null,t.type),a.a.createElement(P.a.Cell,null,t.count),a.a.createElement(P.a.Cell,null,t.price),a.a.createElement(P.a.Cell,null,a.a.createElement(w.a,{onClick:e.remove,name:t._id},"Remove")))});return a.a.createElement(P.a,{celled:!0},a.a.createElement(P.a.Header,null,a.a.createElement(P.a.Row,null,a.a.createElement(P.a.HeaderCell,null,"Type"),a.a.createElement(P.a.HeaderCell,null,"Count"),a.a.createElement(P.a.HeaderCell,null,"Price"),a.a.createElement(P.a.HeaderCell,null,"Remove"))),a.a.createElement(P.a.Body,null,t))}}]),t}(a.a.Component),B=Object(y.b)(function(e){return console.log(e),console.log(e.shopping.list),{isLogged:e.login.isLogged,list:e.shopping.list}})(M),W=n(328),$=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).submit=function(e){e.preventDefault();var t={type:n.state.type,count:n.state.count,price:n.state.price};n.props.dispatch(F(t))},n.onChange=function(e){var t={};t[e.target.name]=e.target.value,n.setState(t)},n.state={type:"",count:0,price:0},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(W.a,{onSubmit:this.submit},a.a.createElement(W.a.Field,null,a.a.createElement("label",{htmlFor:"type"},"Type"),a.a.createElement("input",{type:"text",name:"type",onChange:this.onChange,value:this.state.type})),a.a.createElement(W.a.Field,null,a.a.createElement("label",{htmlFor:"count"},"Count"),a.a.createElement("input",{type:"number",name:"count",onChange:this.onChange,minimum:"0",step:"1",value:this.state.count})),a.a.createElement(W.a.Field,null,a.a.createElement("label",{htmlFor:"price"},"Price"),a.a.createElement("input",{type:"number",name:"price",minimum:"0",step:"0.01",onChange:this.onChange,value:this.state.price})),a.a.createElement(w.a,{type:"submit"},"Add"))}}]),t}(a.a.Component),q=Object(y.b)()($),z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t={};t[e.target.name]=e.target.value,n.setState(t)},n.submit=function(e){if(e.preventDefault(),0!==n.state.username.length&&0!==n.state.password.length){var t={username:n.state.username,password:n.state.password};"register"===e.target.name?n.props.dispatch(m(t)):n.props.dispatch(h(t))}},n.state={username:"",password:""},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(W.a,null,a.a.createElement(W.a.Field,null,a.a.createElement("label",{htmlFor:"username"},"Username"),a.a.createElement("input",{type:"text",name:"username",onChange:this.onChange,value:this.state.username})),a.a.createElement(W.a.Field,null,a.a.createElement("label",{htmlFor:"password"},"Password"),a.a.createElement("input",{type:"password",name:"password",onChange:this.onChange,value:this.state.password})),a.a.createElement(w.a,{onClick:this.submit,name:"register"},"Register"),a.a.createElement(w.a,{onClick:this.submit,name:"login"},"Login"))}}]),t}(a.a.Component),K=Object(y.b)()(z),Q=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement(_.a,null,a.a.createElement(T.a,{exact:!0,path:"/",render:function(){return e.props.isLogged?a.a.createElement(G.a,{to:"/list"}):a.a.createElement(K,null)}}),a.a.createElement(T.a,{path:"/list",render:function(){return e.props.isLogged?a.a.createElement(B,{list:e.props.list,removeFromList:e.props.removeFromList}):a.a.createElement(G.a,{to:"/"})}}),a.a.createElement(T.a,{path:"/form",render:function(){return e.props.isLogged?a.a.createElement(q,{addToList:e.props.addToList}):a.a.createElement(G.a,{to:"/"})}}))}}]),t}(a.a.Component),V=n(334),X=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(j,null),a.a.createElement("hr",null),a.a.createElement(Q,{isLogged:this.props.isLogged}))}}]),t}(r.Component),Y=Object(V.a)(Object(y.b)(function(e){return{isLogged:e.login.isLogged}})(X));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=n(332),ee=n(52),te=n(24);function ne(e,t){sessionStorage.setItem("isLogged",e),sessionStorage.setItem("login_error","")}var re=function(){if(sessionStorage.getItem("isLogged")){var e=!1;"true"===sessionStorage.getItem("isLogged")&&(e=!0);var t="";return sessionStorage.getItem("login_error")&&(t=sessionStorage.getItem("login_error")),{isLogged:e,loading:!1,error:t}}return{isLogged:!1,loading:!1,error:""}}(),ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;console.log("loginReducer, action:"+t.type);var n={};switch(t.type){case"LOGIN_LOADING":return n=Object(te.a)({},e,{loading:!0,error:""});case"REGISTER_SUCCESS":return n=Object(te.a)({},e,{error:"",loading:!1}),ne(e.isLogged),n;case"REGISTER_FAILED":return n=Object(te.a)({},e,{error:t.error,loading:!1}),ne(e.isLogged,t.error),n;case"LOGIN_SUCCESS":return n={isLogged:!0,error:"",loading:!1},ne("true"),n;case"LOGIN_FAILED":return n=Object(te.a)({},e,{error:t.error,loading:!1}),ne(e.isLogged,t.error),n;case"LOGOUT_SUCCESS":return n={isLogged:!1,loading:!1,error:""},sessionStorage.clear(),n;case"LOGOUT_FAILED":return n=Object(te.a)({},e,{loading:!1,error:t.error}),ne(e.isLogged,t.error),n;default:return e}};function oe(e,t){sessionStorage.setItem("shopping_error",t)}var ie=function(){var e="";return sessionStorage.getItem("shopping_error")&&(e=sessionStorage.getItem("shopping_error")),{list:[],error:e,loading:!1}}(),se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;console.log("ShoppingReducer - action:"+t.type);var n={};switch(t.type){case"GET_SHOPPINGLIST_SUCCESS":return n={list:t.list,error:"",loading:!1},oe(t.list,""),n;case"GET_SHOPPINGLIST_FAILED":return n=Object(te.a)({},e,{error:t.error,loading:!1}),oe(e.list,t.error),n;case"ADD_TO_SHOPPINGLIST_SUCCESS":return n=Object(te.a)({},e,{error:""}),oe(e.list,""),n;case"ADD_TO_SHOPPINGLIST_FAILED":return n=Object(te.a)({},e,{loading:!1,error:t.error}),oe(e.list,t.error),n;case"DELETE_FROM_SHOPPINGLIST_SUCCESS":return n=Object(te.a)({},e,{error:""}),oe(e.list,""),n;case"DELETE_FROM_SHOPPINGLIST_FAILED":return n=Object(te.a)({},e,{error:t.error,loading:!1}),oe(e.list,t.error),n;case"SHOPPINGLIST_LOADING":return n=Object(te.a)({},e,{loading:!0});default:return e}},ce=n(170),le=Object(ee.c)({login:ae,shopping:se}),ue=Object(ee.d)(le,Object(ee.a)(ce.a));i.a.render(a.a.createElement(y.a,{store:ue},a.a.createElement(Z.a,null,a.a.createElement(Y,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[182,2,1]]]);
//# sourceMappingURL=main.2249efef.chunk.js.map